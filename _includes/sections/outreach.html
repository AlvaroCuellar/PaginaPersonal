<!-- ·········································
      OUTREACH SECTION
      ········································· -->
<section id="outreach" class="outreach scrollto">
  <div class="row clearfix">
    {% assign lang = page.lang | default: 'es' %}
    <div class="col-1">
      <div class="section-heading">
        {% if site.data.home.outreach.subtitle[lang] %}
          <h3>{{ site.data.home.outreach.subtitle[lang] }}</h3>
        {% endif %}
        <h2 class="section-title">
          {{ site.data.home.outreach.section_title[lang] }}
          <span class="section-count">{{ site.data.home.outreach.items.size }}</span>
        </h2>
      </div>
      
      <!-- Featured Articles Carousel -->
      {% assign featured_ids = site.data.home.outreach.featured_ids %}
      {% if featured_ids.size > 0 %}
        <div class="outreach-featured-carousel-container">
          <div class="outreach-featured-carousel">
            <div class="outreach-carousel-track">
            {% for featured_id in featured_ids %}
              {% assign featured = site.data.home.outreach.items | where: "id", featured_id | first %}
              {% if featured %}
                <div class="outreach-featured-slide">
                  <div class="outreach-featured">
                    <div class="featured-badge">
                      <i class="fa fa-star"></i>
                      <span>{{ site.data.i18n[lang].featured_label }}</span>
                    </div>
                    
                    <div class="featured-content">
                      <h3 class="featured-title">{{ featured.title[lang] }}</h3>
                      
                      {% if featured.description[lang] %}
                        <p class="featured-description">{{ featured.description[lang] }}</p>
                      {% endif %}
                      
                      <div class="featured-meta">
                        <span class="featured-medium">
                          {% case featured.type %}
                            {% when 'article' %}
                              <i class="fa fa-file-text"></i>
                            {% when 'tv' %}
                              <i class="fa fa-tv"></i>
                            {% when 'interview' %}
                              <i class="fa fa-comment"></i>
                          {% endcase %}
                          {{ featured.medium }}
                        </span>
                        <span class="featured-date">
                          {% assign date = featured.date | date: "%-d" %}
                          {% assign month = featured.date | date: "%B" | downcase %}
                          {% assign year = featured.date | date: "%Y" %}
                          {% assign translated_month = site.data.i18n[lang].months[month] %}
                          {{ date }} {{ translated_month | default: month | capitalize }} {{ year }}
                        </span>
                      </div>
                    
                      <a href="{{ featured.url }}" target="_blank" rel="noopener noreferrer" class="button-inverse no-icon">
                        {% if featured.type == 'tv' %}
                          {{ site.data.i18n[lang].outreach.watch }}
                        {% else %}
                          {{ site.data.i18n[lang].outreach.read }}
                        {% endif %}
                      </a>
                    </div>
                    
                    <!-- Decorative circle -->
                    <div class="featured-decoration"></div>
                  </div>
                </div>
              {% endif %}
            {% endfor %}
            </div>
          </div>
          
          <!-- Navigation controls -->
          {% if featured_ids.size > 1 %}
            <div class="outreach-carousel-indicators">
              <button class="outreach-carousel-prev" aria-label="Anterior">
                <i class="fa fa-chevron-left"></i>
              </button>
              
              {% for featured_id in featured_ids %}
                <button class="outreach-indicator{% if forloop.first %} active{% endif %}" data-slide="{{ forloop.index0 }}" aria-label="Ir a slide {{ forloop.index }}"></button>
              {% endfor %}
              
              <button class="outreach-carousel-next" aria-label="Siguiente">
                <i class="fa fa-chevron-right"></i>
              </button>
            </div>
          {% endif %}
        </div>
      {% endif %}
      
      <!-- More Articles Grid -->
      <div class="outreach-more">
        <h3 class="more-title">
          {{ site.data.i18n[lang].outreach.more_title }}
        </h3>
        
        <div class="outreach-grid">
          {% assign initial_visible = 6 %}
          {% assign item_count = 0 %}
          {% assign repeat_featured = site.data.home.outreach.repeat_featured_in_all | default: false %}
          {% assign sorted_items = site.data.home.outreach.items | sort: "date" | reverse %}
          {% for item in sorted_items %}
            {% assign should_show = false %}
            {% if repeat_featured %}
              {% assign should_show = true %}
            {% else %}
              {% unless featured_ids contains item.id %}
                {% assign should_show = true %}
              {% endunless %}
            {% endif %}
            
            {% if should_show %}
              {% assign item_count = item_count | plus: 1 %}
              <article class="outreach-card{% if item_count > initial_visible %} hidden{% endif %}" data-type="{{ item.type }}">
                <div class="category-badge badge-{{ item.type }}">
                  {% case item.type %}
                    {% when 'article' %}
                      <i class="fa fa-file-text"></i>
                    {% when 'tv' %}
                      <i class="fa fa-tv"></i>
                    {% when 'interview' %}
                      <i class="fa fa-comment"></i>
                  {% endcase %}
                  <span>{{ site.data.i18n[lang].outreach_types[item.type] }}</span>
                </div>
                
                <!-- Card Content (using shared classes from cards.css) -->
                <h4 class="card-title card-title-clamp">{{ item.title[lang] }}</h4>
                
                <div class="card-metadata">
                  <span class="card-metadata-highlight">{{ item.medium }}</span>
                  <span class="card-metadata-separator">•</span>
                  <span class="card-date">
                    {% assign date = item.date | date: "%-d" %}
                    {% assign month = item.date | date: "%B" | downcase %}
                    {% assign year = item.date | date: "%Y" %}
                    {% assign translated_month = site.data.i18n[lang].months[month] %}
                    {{ date }} {{ translated_month | default: month | capitalize }} {{ year }}
                  </span>
                </div>
                
                {% if item.description[lang] %}
                  <p class="card-description card-description-clamp">{{ item.description[lang] }}</p>
                {% endif %}
                
                <a href="{{ item.url }}" target="_blank" rel="noopener noreferrer" class="card-link no-icon">
                  {% if item.type == 'tv' %}
                    {{ site.data.i18n[lang].outreach.watch }}
                  {% else %}
                    {{ site.data.i18n[lang].outreach.read }}
                  {% endif %}
                  <i class="fa fa-arrow-right"></i>
                </a>
              </article>
            {% endif %}
          {% endfor %}
        </div>
        
        <!-- Show more button -->
        {% if repeat_featured %}
          {% assign total_non_featured = site.data.home.outreach.items.size %}
        {% else %}
          {% assign total_non_featured = site.data.home.outreach.items.size | minus: featured_ids.size %}
        {% endif %}
        {% if total_non_featured > initial_visible %}
            <div class="show-more-outreach-container" style="text-align: center; margin-top: var(--spacing-xl);">
              <button id="show-more-outreach" class="button">
                {{ site.data.i18n[lang].show_more_outreach | default: "Ver más artículos" }}
              </button>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</section>
<!--End of Outreach-->